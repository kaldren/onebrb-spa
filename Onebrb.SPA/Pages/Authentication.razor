@page "/authentication/{action}"
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@using OnebrbApi
<RemoteAuthenticatorView Action="@Action" OnLogInSucceeded="OnLoginSucceeded" />

@inject IOnebrbApiClient OnebrbApiClient
@inject NavigationManager NavigationManager

@code {
    [Parameter] public string? Action { get; set; }
    private static int count = 0;

    private async Task OnLoginSucceeded() 
    {
        if (Action == "login-callback" && count == 0)
        {
            count++;
            await OnebrbApiClient.ActivateAsync();
        }
    }
}
