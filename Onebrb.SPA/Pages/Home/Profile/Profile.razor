@page "/profiles/{id:long?}"

@using System.Globalization
@using Onebrb.SPA.Models

@inject HttpClient Http
@inject IStringLocalizer<Profile> Loc
@inject IConfiguration Configuration

<PageTitle>Profile</PageTitle>

@if (@res is null) {
    <p>Loading...</p>
}
else
{
    <ProfileComponent ProfileModel="profile" />
}

@code {
    [Parameter]
    public long? Id { get; set; }

    private HttpResponseMessage? res;
    private ProfileModel? profile;

    protected override async Task OnInitializedAsync()
    {
        res = await Http.GetAsync($"{Configuration["AppConfiguration:OnebrbAPIEndpoint"]}/profiles/{Id}");

        if (res.IsSuccessStatusCode)
        {
            profile = await Http.GetFromJsonAsync<ProfileModel>($"{Configuration["AppConfiguration:OnebrbAPIEndpoint"]}/profiles/{Id}");
        }
    }
}
